# Транспортный слой

Duit обеспечивает возможность запроса и получения начального макета экрана/виджета, а также
обработки действий, их публикации на сервер и получение событий в качестве ответа на выполненное
действие. Все эти взаимодействия происходят благодаря транспортному слою, который реализует
механизмы передачи данных по сети или при интеграции с нативным приложением.

## Виды транспорта

Duit из коробки реализует два основных вида транспорта, предназначенныее для работы по определенным
сетевым протоколам. Это `HttpTransport` и `WebSocketTransport` для http и ws соотвественно.

Реализация HttpTransport использует в качестве http-клиента
пакет [http](https://pub.dev/packages/http).

Реализация WebSocketTransport использует реализацию из пакета [dart:io](https://dart.dev/libraries/dart-io).

## Интерфейс транспорта

Все реализации транспортные слоя реализуют интерфейс `Transport`.

В этот интерфейс входят следующие методы:

- `connect` - метод отвечает за выполенние запроса начального макета экрана/виджета
- `dispose` - метод очистки ресурсов
- `execute` - метод для выполнения действий
- `request` - служебный метод для выполнения произвольных запросов или публикации событий.
  Предназначен для использования внутренними инструментами Duit, например `ScriptRunner`.

## Конфигурация транспортного слоя

Для конфигурации транспорта используются классы-наследники TransportOptions. Этот класс представляет
собой базовую конфигурацию, необходимую для инициализации необходимого транспорта с указанными
параметрами.

Конфигурация транспорта происходит на этапе создания экземпляра DuitDriver путем передачи
необходимого объекта `HttpTransportOptions` или `WebSocketTransportOptions`.

```dart
  late final DuitDriver driver;

@override
void initState() {
  driver = DuitDriver(
    "/example_screen",
    transportOptions: HttpTransportOptions(
      defaultHeaders: {
        "Content-Type": "application/json",
      },
      baseUrl: "http://localhost:8999",
      decoder: CustomDecoder(),
    ),
  );
  super.initState();
}
```

## Использование сторонних http-клиентов и сетевых протоколов

Duit допускает возможность переопределение транспортного слоя для использования сторонних
http-клиентов или реализации используемых в приложении сетевых протоколов вместо поддерживаемых из
коробки.

Для этого требуется создать собственные реализации интерфейсов `Transport` и `TransportOptions`.
Подробнее о переопределении транспортного слоя можно узнать в
соотвествующем [разделе](/docs/advanced_tech/transport_override) документации.

<!-- ## Роль транспорта в интеграции с нативными приложениями

`NativeTransport` - особая реализация интерфейса `Transport`, предоставляющая асинхронный API для
взаимодействия c
нативными приложениями и обеспечением обмена данными между Dart-кодом и нативом, построенный на
базе [`Platform channels`](https://docs.flutter.dev/platform-integration/platform-channels#architecture).
При таком способе интеграции за взаимодействие с сетью отвечает нативная часть приложения, которая в
свою очередь пересылает данные и события на сторону Dart, где Duit обрабатывает их.

Подробнее об этой части функционала Duit можно узнать в
соотвествующем [разделе](/docs/core_concepts/native) документации. -->